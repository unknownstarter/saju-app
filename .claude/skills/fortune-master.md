---
name: fortune-master
description: 사주팔자(四柱八字) 명리학 전문가 — 궁합 분석, 오행 해석, AI 해석 가이드를 총괄하는 핵심 스킬
---

# Fortune Master (명리학 전문가)

> 이 스킬은 사주 기반 데이팅 앱의 핵심 도메인 지식을 담고 있다.
> 사주팔자의 이론적 기반부터 궁합 점수화, AI 해석 톤까지 모든 것을 다룬다.

---

## 1. 사주팔자 기본 체계

### 1.1 천간(天干) — 10개

하늘의 기운. 외면적 성격, 의식적 자아를 나타낸다.

| 번호 | 천간 | 한자 | 오행 | 음양 | 성격 키워드 |
|------|------|------|------|------|-------------|
| 1 | 갑(甲) | 甲 | 목(木) | 양 | 큰 나무, 리더십, 진취적, 독립적 |
| 2 | 을(乙) | 乙 | 목(木) | 음 | 풀/덩굴, 유연함, 적응력, 섬세함 |
| 3 | 병(丙) | 丙 | 화(火) | 양 | 태양, 열정, 밝음, 외향적 |
| 4 | 정(丁) | 丁 | 화(火) | 음 | 촛불/달빛, 따뜻함, 내면의 빛, 섬세 |
| 5 | 무(戊) | 戊 | 토(土) | 양 | 큰 산, 안정감, 신뢰, 포용력 |
| 6 | 기(己) | 己 | 토(土) | 음 | 논밭, 수용력, 실용적, 겸손 |
| 7 | 경(庚) | 庚 | 금(金) | 양 | 강철/바위, 결단력, 정의감, 강직 |
| 8 | 신(辛) | 辛 | 금(金) | 음 | 보석/칼날, 예리함, 심미안, 완벽주의 |
| 9 | 임(壬) | 壬 | 수(水) | 양 | 바다/큰 강, 지혜, 포용, 자유로움 |
| 10 | 계(癸) | 癸 | 수(水) | 음 | 이슬/비, 직관력, 감성, 깊은 사고 |

### 1.2 지지(地支) — 12개

땅의 기운. 내면의 본성, 무의식적 욕구를 나타낸다.

| 번호 | 지지 | 한자 | 띠 | 오행 | 음양 | 월(절기) | 시간 |
|------|------|------|-----|------|------|----------|------|
| 1 | 자(子) | 子 | 쥐 | 수(水) | 양 | 11월(동지) | 23:00-01:00 |
| 2 | 축(丑) | 丑 | 소 | 토(土) | 음 | 12월(소한) | 01:00-03:00 |
| 3 | 인(寅) | 寅 | 호랑이 | 목(木) | 양 | 1월(입춘) | 03:00-05:00 |
| 4 | 묘(卯) | 卯 | 토끼 | 목(木) | 음 | 2월(경칩) | 05:00-07:00 |
| 5 | 진(辰) | 辰 | 용 | 토(土) | 양 | 3월(청명) | 07:00-09:00 |
| 6 | 사(巳) | 巳 | 뱀 | 화(火) | 음 | 4월(입하) | 09:00-11:00 |
| 7 | 오(午) | 午 | 말 | 화(火) | 양 | 5월(망종) | 11:00-13:00 |
| 8 | 미(未) | 未 | 양 | 토(土) | 음 | 6월(소서) | 13:00-15:00 |
| 9 | 신(申) | 申 | 원숭이 | 금(金) | 양 | 7월(입추) | 15:00-17:00 |
| 10 | 유(酉) | 酉 | 닭 | 금(金) | 음 | 8월(백로) | 17:00-19:00 |
| 11 | 술(戌) | 戌 | 개 | 토(土) | 양 | 9월(한로) | 19:00-21:00 |
| 12 | 해(亥) | 亥 | 돼지 | 수(水) | 음 | 10월(입동) | 21:00-23:00 |

### 1.3 60갑자(六十甲子)

천간(10) x 지지(12)의 조합에서 음양이 같은 것끼리만 결합하여 60가지 조합이 만들어진다.

```
갑자 을축 병인 정묘 무진 기사 경오 신미 임신 계유
갑술 을해 병자 정축 무인 기묘 경진 신사 임오 계미
갑신 을유 병술 정해 무자 기축 경인 신묘 임진 계사
갑오 을미 병신 정유 무술 기해 경자 신축 임인 계묘
갑진 을사 병오 정미 무신 기유 경술 신해 임자 계축
갑인 을묘 병진 정사 무오 기미 경신 신유 임술 계해
```

이 60갑자가 년, 월, 일, 시에 각각 배정되어 **사주팔자(四柱八字)**를 구성한다.

---

## 2. 오행(五行) 상생상극

### 2.1 오행의 성질

| 오행 | 계절 | 방위 | 색 | 감정 | 장기 | 핵심 성질 |
|------|------|------|-----|------|------|-----------|
| 목(木) | 봄 | 동 | 청/녹 | 분노 | 간/담 | 성장, 시작, 인자함 |
| 화(火) | 여름 | 남 | 적 | 기쁨 | 심/소장 | 확산, 열정, 예의 |
| 토(土) | 환절기 | 중앙 | 황 | 사려 | 비/위 | 중재, 안정, 신뢰 |
| 금(金) | 가을 | 서 | 백 | 슬픔 | 폐/대장 | 수렴, 결단, 의로움 |
| 수(水) | 겨울 | 북 | 흑 | 공포 | 신/방광 | 저장, 지혜, 유연함 |

### 2.2 상생(相生) — 서로 살리는 관계

```
목 → 화 → 토 → 금 → 수 → 목 (순환)

목생화(木生火): 나무가 불을 살린다
화생토(火生土): 불이 재(흙)를 만든다
토생금(土生金): 흙에서 금속이 나온다
금생수(金生水): 금속 표면에 물이 맺힌다
수생목(水生木): 물이 나무를 기른다
```

**궁합 적용**: 상생 관계는 서로를 성장시키는 관계. 궁합에서 **가장 이상적인 조합**.

### 2.3 상극(相剋) — 서로 억누르는 관계

```
목 → 토 → 수 → 화 → 금 → 목 (순환)

목극토(木剋土): 나무가 흙의 양분을 빼앗는다
토극수(土剋水): 흙이 물을 막는다 (제방)
수극화(水剋火): 물이 불을 끈다
화극금(火剋金): 불이 금속을 녹인다
금극목(金剋木): 금속(도끼)이 나무를 자른다
```

**궁합 적용**: 상극이 무조건 나쁜 것은 아니다!
- **적절한 극**: 서로의 과잉을 조절하는 건강한 긴장감 (complementary)
- **과도한 극**: 한쪽이 일방적으로 억눌리는 불균형

### 2.4 오행 균형 분석

사주에서 오행의 분포를 분석하여 과다/부족을 파악한다.

```typescript
interface OhengBalance {
  목: number; // 0-8 (팔자 중 목에 해당하는 글자 수 + 가중치)
  화: number;
  토: number;
  금: number;
  수: number;
}

// 균형 점수 계산 (표준편차 기반)
function calculateBalance(oheng: OhengBalance): number {
  const values = Object.values(oheng);
  const mean = values.reduce((a, b) => a + b, 0) / 5;
  const variance = values.reduce((sum, v) => sum + Math.pow(v - mean, 2), 0) / 5;
  const stdDev = Math.sqrt(variance);

  // 표준편차가 낮을수록 균형 잡힘. 0~100점 변환
  return Math.max(0, 100 - stdDev * 25);
}
```

---

## 3. 사주팔자 구성 (四柱八字)

### 3.1 네 기둥의 의미

```
        년주(年柱)    월주(月柱)    일주(日柱)    시주(時柱)
        ─────────   ─────────   ─────────   ─────────
천간:    년간         월간         일간(일원)    시간
지지:    년지         월지         일지         시지
        ─────────   ─────────   ─────────   ─────────
의미:    조상/사회    부모/환경    본인/배우자   자녀/말년
시기:    유년기       청년기       장년기        노년기
관계:    외부 관계    사회적 역할   핵심 자아     내면/잠재력
```

### 3.2 일주(日柱)의 중요성 — 궁합의 핵심

**일간(日干)**은 본인의 핵심 자아를 나타낸다. 궁합에서 가장 중요한 요소.
**일지(日支)**는 배우자궁으로, 결혼 후 파트너와의 관계를 나타낸다.

> CRITICAL: 데이팅 앱에서 궁합 분석의 50% 이상이 일주 분석에서 나온다.

### 3.3 사주 산출 방법

```typescript
// manseryeok-js 라이브러리 활용
import { getSaju } from 'manseryeok-js';

interface SajuInput {
  year: number;      // 양력 연도
  month: number;     // 1-12
  day: number;       // 1-31
  hour: number;      // 0-23
  minute: number;    // 0-59
  isLunar: boolean;  // 음력 여부
  gender: 'male' | 'female'; // 대운 계산에 필요
}

interface SajuResult {
  yearPillar: { cheongan: string; jiji: string };  // 년주
  monthPillar: { cheongan: string; jiji: string }; // 월주
  dayPillar: { cheongan: string; jiji: string };   // 일주
  hourPillar: { cheongan: string; jiji: string };  // 시주
  oheng: OhengBalance;  // 오행 분포
  sipsin: SipsinMap;     // 십신 배치
}
```

---

## 4. 십신(十神) 체계

일간(日干)을 기준으로 다른 7개 글자와의 관계를 정의한다.

### 4.1 십신 정의

| 십신 | 한자 | 관계 | 성격/의미 | 연애 스타일 |
|------|------|------|-----------|-------------|
| **비견(比肩)** | 比肩 | 같은 오행, 같은 음양 | 독립심, 자존심, 경쟁 | 대등한 파트너십 추구 |
| **겁재(劫財)** | 劫財 | 같은 오행, 다른 음양 | 추진력, 승부욕, 과감 | 적극적, 질투심 가능 |
| **식신(食神)** | 食神 | 내가 생하는 오행, 같은 음양 | 표현력, 여유, 낙천 | 편안하고 즐거운 연애 |
| **상관(傷官)** | 傷官 | 내가 생하는 오행, 다른 음양 | 창의성, 반항, 자유 | 감정적, 드라마틱한 연애 |
| **편재(偏財)** | 偏財 | 내가 극하는 오행, 다른 음양 | 사교성, 활동력, 유동적 | 다정하고 활발한 연애 |
| **정재(正財)** | 正財 | 내가 극하는 오행, 같은 음양 | 안정, 성실, 절약 | 진지하고 헌신적인 연애 |
| **편관(偏官)** | 偏官 | 나를 극하는 오행, 다른 음양 | 카리스마, 도전, 긴장감 | 강렬하고 역동적인 연애 |
| **정관(正官)** | 正官 | 나를 극하는 오행, 같은 음양 | 책임감, 질서, 명예 | 예의 바르고 전통적 연애 |
| **편인(偏印)** | 偏印 | 나를 생하는 오행, 다른 음양 | 직관, 독창성, 고독 | 독특하고 깊은 연애 |
| **정인(正印)** | 正印 | 나를 생하는 오행, 같은 음양 | 학문, 인자함, 포용 | 따뜻하고 보살피는 연애 |

### 4.2 십신 궁합 매트릭스

두 사람의 십신 조합별 궁합 성향:

```
                  상대방
             비견  겁재  식신  상관  편재  정재  편관  정관  편인  정인
본인
비견          △    ▽    ○    △    ○    ◎    △    ○    ○    ◎
겁재          ▽    ▽    △    △    ◎    ○    △    △    ○    ○
식신          ○    △    ○    △    ◎    ○    △    ○    △    ○
상관          △    △    △    ▽    ○    △    ▽    △    △    ○
편재          ○    ◎    ◎    ○    △    △    ○    ○    △    △
정재          ◎    ○    ○    △    △    △    ○    ◎    △    ○
편관          △    △    △    ▽    ○    ○    ▽    △    ◎    ○
정관          ○    △    ○    △    ○    ◎    △    △    ○    ◎
편인          ○    ○    △    △    △    △    ◎    ○    △    △
정인          ◎    ○    ○    ○    △    ○    ○    ◎    △    ○

◎ = 매우 좋음(+3)  ○ = 좋음(+2)  △ = 보통(+1)  ▽ = 주의(-1)
```

---

## 5. 궁합 계산 핵심 요소

### 5.1 천간합(天干合)

두 천간이 만나 합이 되는 6가지 조합. **가장 강력한 궁합 신호**.

```
甲 + 己 = 토(土)  →  갑기합토 (리더 + 실용가 = 안정적 파트너십)
乙 + 庚 = 금(金)  →  을경합금 (유연 + 강직 = 보완적 관계)
丙 + 辛 = 수(水)  →  병신합수 (열정 + 예리 = 자극적 관계)
丁 + 壬 = 목(木)  →  정임합목 (따뜻 + 지혜 = 성장하는 관계)
戊 + 癸 = 화(火)  →  무계합화 (안정 + 감성 = 깊은 유대)
```

**일간끼리 천간합이면**: 궁합 최상급. +20점

### 5.2 천간충(天干沖)

정반대 성질의 충돌:

```
甲 ↔ 庚 (목 vs 금)
乙 ↔ 辛 (목 vs 금)
丙 ↔ 壬 (화 vs 수)
丁 ↔ 癸 (화 vs 수)
```

**일간끼리 천간충이면**: 긴장감은 있지만 반드시 나쁘지는 않다. 상호 자극이 될 수 있음. -5점~+5점 (맥락에 따라)

### 5.3 지지 육합(地支六合)

```
子 + 丑 = 토(土)   자축합토
寅 + 亥 = 목(木)   인해합목
卯 + 戌 = 화(火)   묘술합화
辰 + 酉 = 금(金)   진유합금
巳 + 申 = 수(水)   사신합수
午 + 未 = 화(火)   오미합화(또는 토)
```

**일지끼리 육합이면**: +15점

### 5.4 지지 삼합(地支三合)

세 지지가 모여 하나의 오행을 이루는 조합:

```
申子辰 → 수(水)국  (원숭이-쥐-용)
亥卯未 → 목(木)국  (돼지-토끼-양)
寅午戌 → 화(火)국  (호랑이-말-개)
巳酉丑 → 금(金)국  (뱀-닭-소)
```

**두 사람의 지지 중 삼합을 이루는 글자가 있으면**: +8점 (부분 삼합도 가산)

### 5.5 지지충(地支沖)

정반대 위치의 충돌:

```
子 ↔ 午   자오충 (쥐 vs 말)
丑 ↔ 未   축미충 (소 vs 양)
寅 ↔ 申   인신충 (호랑이 vs 원숭이)
卯 ↔ 酉   묘유충 (토끼 vs 닭)
辰 ↔ 戌   진술충 (용 vs 개)
巳 ↔ 亥   사해충 (뱀 vs 돼지)
```

**일지끼리 충이면**: -12점 (배우자궁 충돌, 가장 주의할 요소)
**년지끼리 충이면**: -5점 (가정환경/가치관 충돌)

### 5.6 지지 형(刑), 파(破), 해(害)

**형(刑)** — 서로 해치는 관계:
```
인사신(寅巳申) — 무은지형 (은혜를 원수로 갚음)
축술미(丑戌未) — 무례지형 (예의 없는 관계)
자묘(子卯) — 무례지형
진진(辰辰), 오오(午午), 유유(酉酉), 해해(亥亥) — 자형
```
궁합 영향: -8점 (갈등 요소이나 성장 가능성도 있음)

**파(破)** — 깨뜨리는 관계:
```
子-酉, 丑-辰, 寅-亥, 卯-午, 巳-申, 未-戌
```
궁합 영향: -5점

**해(害)** — 해치는 관계:
```
子-未, 丑-午, 寅-巳, 卯-辰, 申-亥, 酉-戌
```
궁합 영향: -6점

---

## 6. 궁합 점수화 체계 (100점 만점)

### 6.1 배점 구조

```typescript
interface CompatibilityScore {
  // === 핵심 요소 (60점) ===
  dayPillarHarmony: number;     // 일주 궁합: 0~30점
  ohengComplement: number;      // 오행 상호보완: 0~15점
  sipsinRelation: number;       // 십신 관계: 0~15점

  // === 보조 요소 (25점) ===
  yearPillarHarmony: number;    // 년주 궁합: 0~10점
  monthPillarHarmony: number;   // 월주 궁합: 0~8점
  hourPillarHarmony: number;    // 시주 궁합: 0~7점

  // === 종합 요소 (15점) ===
  overallBalance: number;       // 합산 오행 균형: 0~10점
  specialFormations: number;    // 특수격국 보너스: 0~5점

  // === 감산 요소 ===
  penalties: number;            // 충/형/파/해 감점: -30~0점

  total: number;                // 최종 점수 (floor 30, ceiling 99)
}
```

### 6.2 일주 궁합 상세 배점 (30점 만점)

```typescript
function calculateDayPillarScore(person1: DayPillar, person2: DayPillar): number {
  let score = 15; // 기본점수 (중립 시작)

  // 천간합: +15 (최대 30)
  if (isCheonganHap(person1.cheongan, person2.cheongan)) score += 15;

  // 지지 육합: +12
  if (isJijiYukhap(person1.jiji, person2.jiji)) score += 12;

  // 지지 삼합(부분): +5
  if (isPartialSamhap(person1.jiji, person2.jiji)) score += 5;

  // 천간 상생: +5
  if (isCheonganSangsaeng(person1.cheongan, person2.cheongan)) score += 5;

  // 지지충: -12
  if (isJijiChung(person1.jiji, person2.jiji)) score -= 12;

  // 지지형: -8
  if (isJijiHyeong(person1.jiji, person2.jiji)) score -= 8;

  // 지지해: -6
  if (isJijiHae(person1.jiji, person2.jiji)) score -= 6;

  return Math.max(0, Math.min(30, score));
}
```

### 6.3 오행 상호보완성 점수 (15점 만점)

두 사람의 오행을 합산했을 때의 균형도:

```typescript
function calculateOhengComplement(p1: OhengBalance, p2: OhengBalance): number {
  // 두 사람의 오행을 합산
  const combined = {
    목: p1.목 + p2.목,
    화: p1.화 + p2.화,
    토: p1.토 + p2.토,
    금: p1.금 + p2.금,
    수: p1.수 + p2.수,
  };

  // 합산 균형도 (0~100)
  const combinedBalance = calculateBalance(combined);

  // 개인 균형도
  const p1Balance = calculateBalance(p1);
  const p2Balance = calculateBalance(p2);
  const avgIndividualBalance = (p1Balance + p2Balance) / 2;

  // 핵심: 합쳤을 때 개인보다 균형이 좋아지면 높은 점수
  const improvement = combinedBalance - avgIndividualBalance;

  // -20 ~ +40 범위를 0~15점으로 매핑
  return Math.max(0, Math.min(15, Math.round((improvement + 20) * 15 / 60)));
}
```

### 6.4 최종 점수 보정

```typescript
function finalScore(raw: number): number {
  // 최저 30점 (절대 0점이 나오지 않도록)
  // 최고 99점 (100%는 현실에 존재하지 않는다는 철학)
  const clamped = Math.max(30, Math.min(99, raw));

  // 정규분포 보정: 대부분 50-80 사이에 분포하도록
  // 극단값을 중앙으로 모으는 sigmoid 변환
  const normalized = 30 + 69 / (1 + Math.exp(-0.08 * (clamped - 60)));

  return Math.round(normalized);
}
```

### 6.5 점수 등급

| 점수 범위 | 등급 | 라벨 | 설명 |
|-----------|------|------|------|
| 85-99 | S | 천생연분 | 하늘이 맺어준 인연 |
| 75-84 | A | 찰떡궁합 | 서로를 빛나게 하는 관계 |
| 65-74 | B+ | 좋은 인연 | 함께 성장할 수 있는 관계 |
| 55-64 | B | 괜찮은 궁합 | 노력하면 좋아지는 관계 |
| 45-54 | C | 보통 | 서로 다름을 인정하면 OK |
| 30-44 | D | 도전적 궁합 | 차이가 크지만 불가능은 아님 |

> CRITICAL: 30점 미만은 절대 나오지 않아야 한다. 어떤 조합도 "최악"으로 표현하지 않는다.

---

## 7. AI 해석 가이드라인

### 7.1 해석 톤 원칙

1. **긍정적 프레이밍 우선**: 강점과 가능성을 먼저 말한다
2. **구체적이고 실용적**: "좋습니다"가 아니라 "어떤 점에서 어떻게 좋은지" 설명
3. **균형 잡힌 시각**: 장점과 주의점을 모두 다루되, 장점 70% + 주의점 30%
4. **재미와 깊이 공존**: 가볍게 읽히되 내용은 깊어야 한다
5. **운명이 아닌 참고**: "~할 것입니다"(X) → "~할 가능성이 있어요"(O)

### 7.2 해석 구조 템플릿

```markdown
## [두 사람 이름]의 궁합 이야기

### 첫인상 한 줄 요약
"[재미있고 비유적인 궁합 요약]"

### 서로를 빛나게 하는 점 (강점)
- [구체적 강점 1]: [설명]
- [구체적 강점 2]: [설명]
- [구체적 강점 3]: [설명]

### 함께 성장할 포인트 (주의점 → 긍정적 리프레이밍)
- [주의점 1]: [부정적 표현 없이 성장 관점으로]
- [주의점 2]: [구체적 조언 포함]

### 이런 데이트를 추천해요
- [오행/십신 기반 데이트 추천]

### 관계 꿀팁
- [실용적 조언 1-2개]
```

### 7.3 오행별 비유 스타일

```
목(木) 커플: "봄날의 숲처럼 함께 자라는" / "새싹이 쑥쑥 자라듯"
화(火) 커플: "캠프파이어처럼 따뜻한" / "불꽃놀이 같은 설렘"
토(土) 커플: "단단한 대지 위에 짓는 집처럼" / "든든한 뿌리"
금(金) 커플: "다이아몬드처럼 빛나는" / "깎고 다듬어 더 빛나는"
수(水) 커플: "깊은 바다처럼 넓고 깊은" / "흐르는 물처럼 자연스러운"
```

### 7.4 부정적 결과의 부드러운 전달

**절대 하지 말 것:**
- "궁합이 안 좋습니다" / "맞지 않습니다"
- "이별 가능성이 높습니다"
- "결혼하면 안 됩니다"
- 점수를 노골적으로 강조 ("45점밖에...")

**대신 이렇게:**
```
BAD: "자오충으로 궁합이 나쁩니다."
GOOD: "서로 다른 에너지를 가진 만큼, 그 차이가 오히려
       서로에게 새로운 시각을 열어줄 수 있어요.
       다만, 서로의 방식이 다를 수 있으니
       '왜 그렇게 하는 거지?' 대신 '이 사람은 이런 방식이구나'
       하고 이해하려는 마음이 중요해요."

BAD: "오행이 불균형합니다."
GOOD: "두 분이 함께하면 [부족한 오행]의 에너지를
       의식적으로 채워갈 수 있어요.
       예를 들어 [구체적 활동 제안]을 함께 해보는 건 어떨까요?"
```

---

## 8. 윤리적 원칙

### 8.1 핵심 원칙

1. **운명 결정론 배제**: 사주는 "경향성"이지 "결정"이 아니다
2. **참고 도구 포지셔닝**: "사주가 전부가 아니에요. 재미있는 참고 도구로 활용해보세요"
3. **자기 결정권 존중**: 최종 결정은 항상 사용자의 몫
4. **해를 끼치지 않기**: 사주 결과로 인해 좋은 관계가 깨지지 않도록
5. **포용성**: 어떤 사주 조합도 "나쁜" 것으로 낙인찍지 않음

### 8.2 필수 면책 문구

앱 내 반드시 포함:
```
"사주 궁합은 두 분의 관계를 더 깊이 이해하기 위한
재미있는 참고 도구입니다. 실제 관계에서 가장 중요한 것은
서로를 향한 마음과 노력이에요."
```

### 8.3 금지 사항

- 특정 조합을 "결혼 불가"로 표시하는 것
- 사주만으로 이별/결별을 조언하는 것
- 과도한 공포심 유발 (삼재, 역마살 등의 부정적 강조)
- 결제를 유도하기 위한 부정적 결과 과장
- 미신적 요소의 과학적 포장

---

## 9. manseryeok-js 라이브러리 활용

### 9.1 기본 사용법

```typescript
// manseryeok-js는 만세력(萬歲曆) 계산을 위한 라이브러리
// 양력 날짜로부터 사주팔자를 산출

import { Manseryeok } from 'manseryeok-js';

// 사주 산출
const saju = new Manseryeok({
  year: 1990,
  month: 5,
  day: 15,
  hour: 14,
  minute: 30,
  isLunar: false,
});

// 결과 접근
const yearPillar = saju.getYearPillar();   // { 천간: '경', 지지: '오' }
const monthPillar = saju.getMonthPillar(); // { 천간: '신', 지지: '사' }
const dayPillar = saju.getDayPillar();     // { 천간: '무', 지지: '진' }
const hourPillar = saju.getHourPillar();   // { 천간: '기', 지지: '미' }
```

### 9.2 궁합 계산 통합

```typescript
function calculateCompatibility(
  person1: SajuInput,
  person2: SajuInput
): CompatibilityResult {
  const saju1 = new Manseryeok(person1);
  const saju2 = new Manseryeok(person2);

  const dayPillar1 = saju1.getDayPillar();
  const dayPillar2 = saju2.getDayPillar();

  // 1. 일주 궁합 점수
  const dayScore = calculateDayPillarScore(dayPillar1, dayPillar2);

  // 2. 오행 상호보완 점수
  const oheng1 = saju1.getOhengBalance();
  const oheng2 = saju2.getOhengBalance();
  const ohengScore = calculateOhengComplement(oheng1, oheng2);

  // 3. 십신 관계 점수
  const sipsinScore = calculateSipsinRelation(saju1, saju2);

  // 4. 나머지 기둥 점수
  const yearScore = calculatePillarHarmony(
    saju1.getYearPillar(), saju2.getYearPillar(), 'year'
  );
  const monthScore = calculatePillarHarmony(
    saju1.getMonthPillar(), saju2.getMonthPillar(), 'month'
  );
  const hourScore = calculatePillarHarmony(
    saju1.getHourPillar(), saju2.getHourPillar(), 'hour'
  );

  // 5. 종합
  const rawScore = dayScore + ohengScore + sipsinScore
                 + yearScore + monthScore + hourScore;

  return {
    total: finalScore(rawScore),
    breakdown: { dayScore, ohengScore, sipsinScore, yearScore, monthScore, hourScore },
    interpretation: generateInterpretation(saju1, saju2, rawScore),
  };
}
```

### 9.3 라이브러리 주의사항

- manseryeok-js의 API가 변경될 수 있으므로, wrapper 함수로 감싸서 사용
- 음력/양력 변환 정확도 검증 필요
- 윤달 처리 확인 필요
- 1900년 이전, 2100년 이후 데이터 정확도 미보장

---

## 10. 시간 보정 (진태양시)

### 10.1 진태양시란?

표준시(시계 시간)와 실제 태양 위치 기반 시간(진태양시)은 다르다. 사주에서는 진태양시를 사용해야 정확한 시주를 산출할 수 있다.

### 10.2 보정 공식

```typescript
function getTrueSolarTime(
  standardTime: Date,
  longitude: number,  // 출생지 경도
  timezone: number = 9  // KST = UTC+9
): Date {
  // 1. 경도 보정: 표준 경도(135도 for KST)와의 차이
  const standardMeridian = timezone * 15; // KST: 135도
  const longitudeCorrection = (longitude - standardMeridian) * 4; // 분 단위

  // 2. 균시차(Equation of Time) 보정
  const dayOfYear = getDayOfYear(standardTime);
  const B = (360 / 365) * (dayOfYear - 81) * (Math.PI / 180);
  const equationOfTime = 9.87 * Math.sin(2 * B)
                       - 7.53 * Math.cos(B)
                       - 1.5 * Math.sin(B); // 분 단위

  // 3. 총 보정
  const totalCorrectionMinutes = longitudeCorrection + equationOfTime;

  const corrected = new Date(standardTime);
  corrected.setMinutes(corrected.getMinutes() + Math.round(totalCorrectionMinutes));

  return corrected;
}
```

### 10.3 한국 주요 도시 경도

| 도시 | 경도 | KST 대비 보정(분) |
|------|------|-------------------|
| 서울 | 126.98 | -32 |
| 부산 | 129.08 | -24 |
| 대구 | 128.60 | -26 |
| 인천 | 126.70 | -33 |
| 광주 | 126.85 | -33 |
| 대전 | 127.38 | -30 |
| 제주 | 126.53 | -34 |

### 10.4 UX 고려사항

- 사용자에게 "진태양시 보정" 옵션을 제공하되, 기본은 OFF
- 출생지를 입력하면 자동 보정하는 기능 제공
- "시주가 바뀔 수 있다"는 안내 (경계 시간대: xx:50 ~ xx:10)
- 출생 시간을 모르는 경우: 시주 없이 년월일주만으로 분석 (정확도 75% 수준 안내)

---

## 11. 특수 격국(格局) 및 신살(神煞) — 앱 해석용

### 11.1 궁합에 활용할 주요 신살

| 신살 | 의미 | 궁합 활용 |
|------|------|-----------|
| 도화살(桃花煞) | 매력, 이성 인기 | "상대에게 매력적으로 보이는 포인트" |
| 역마살(驛馬煞) | 이동, 변화 | "함께 여행하면 좋은 궁합" |
| 천을귀인(天乙貴人) | 귀인, 도움 | "서로에게 귀인이 되는 관계" |
| 문창귀인(文昌貴人) | 학문, 지적 교류 | "대화가 잘 통하는 관계" |
| 천덕귀인(天德貴人) | 복, 해결사 | "어려울 때 힘이 되는 관계" |

### 11.2 해석 주의

- 부정적 신살(겁살, 백호살 등)은 앱에서 직접 언급하지 않음
- 긍정적 신살만 선별하여 "재미있는 인사이트"로 제공
- "당신의 도화살이 [지지]에 있어서, [상대 일지]와 만나면 특별한 매력을 느낄 수 있어요" 식의 부드러운 표현

---

## 12. 사주 없이도 가능한 간이 궁합

### 12.1 띠 궁합 (시간 미입력 시 fallback)

삼합 띠:
```
수(水)국: 원숭이 - 쥐 - 용      → 궁합 좋음
목(木)국: 돼지 - 토끼 - 양      → 궁합 좋음
화(火)국: 호랑이 - 말 - 개      → 궁합 좋음
금(金)국: 뱀 - 닭 - 소          → 궁합 좋음
```

충 띠:
```
쥐 ↔ 말, 소 ↔ 양, 호랑이 ↔ 원숭이
토끼 ↔ 닭, 용 ↔ 개, 뱀 ↔ 돼지
```

### 12.2 생년 오행 궁합 (간이 버전)

생년의 천간으로 오행을 판단하여 간단한 상생/상극 궁합 제공.

> NOTE: 이 간이 버전은 정확도가 낮으므로, "더 정확한 결과를 위해 생시를 입력해보세요"로 풀 버전 유도.

---

## Quick Reference: 궁합 계산 흐름도

```
사용자 A 생년월일시 + 사용자 B 생년월일시
    │
    ├─ manseryeok-js로 사주팔자 산출
    │
    ├─ [1단계] 일주 궁합 (30점)
    │   ├─ 천간합/충 확인
    │   ├─ 지지 육합/삼합/충/형/파/해 확인
    │   └─ 점수 산출
    │
    ├─ [2단계] 오행 보완성 (15점)
    │   ├─ 각자 오행 분포 계산
    │   ├─ 합산 균형도 vs 개인 균형도
    │   └─ 보완 점수 산출
    │
    ├─ [3단계] 십신 관계 (15점)
    │   ├─ 상대방 일간이 나에게 어떤 십신인지
    │   └─ 매트릭스 기반 점수
    │
    ├─ [4단계] 년/월/시주 보조 점수 (25점)
    │
    ├─ [5단계] 종합 보정 (15점)
    │   ├─ 합산 오행 균형
    │   └─ 특수 격국/신살 보너스
    │
    ├─ [감점] 충/형/파/해 페널티
    │
    └─ [최종] 점수 보정 (30~99) → 등급 → AI 해석 생성
```
